
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="title">
                <h2>場館介紹</h2>
            </div>
        </div>
    </div>
</div>


<div id="location" class="container-fluid p-5">
    <div>
        <div class="card">
            <div class="card-header">
                搜尋
            </div>
            <div class="card-body">
                <form class="row g-3">
                    <div class="col-md-auto">
                        <label class="form-label">地區</label>
                        <select v-model="areas" class="form-control">
                            <option :value="items" v-for="items in areaOptionList" :key="items"> {{items}} </option>
                        </select>
                    </div>
                    <div class="col-md-auto">
                        <label for="category" class="form-label">種類</label>
                        <select class="form-control" id="category" v-model="category">
                            <option value="1">籃球</option>
                            <option value="2">壘球</option>
                            <option value="3">壁球</option>
                        </select>
                    </div>
                    <div class="col-md-auto">
                        <label for="keywords" class="form-label">關鍵字</label>
                        <input type="text" class="form-control" v-model="keywords" placeholder="輸入搜尋">
                    </div>
                    <div class="col-md-auto d-flex justify-content-end">
                        <button type="button" class="btn btn-primary" @@click="search"> 搜尋</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="row">
        <div v-for="item in temp" key="item.name" class="col-md-4">
            <div class="p-3">
                <div class="row g-0 border rounded flex-md-row mb-4 shadow-sm">
                    <div class="col p-4 d-flex flex-column position-static">
                        <stron class=" mb-4 badge rounded-pill bg-dark text-light">{{item.area}}</stron>
                        <h1 class="fw-bolder mb-1 justify-content-center">{{item.name}}</h1>
                        <div class="mb-auto text-muted">{{item.englishName}}</div>
                        <p class="mb-auto">{{item.name}}</p> <!--tag預留-->
                        <p class="mb-auto">{{item.description}}</p>
                        <a href="/venue/details" class="stretched-link">更多資訊</a>

                    </div>
                    <div class="d-none d-lg-block">
                        <img v-bind:src="`/images/${item.path}`" height="200" />
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
let app = new Vue({
    el: "#location",
    data: {
        keywords: "",
        areas: "",
        category: "1",
        venue: [],
        temp: []
    },
    methods: {
        hasKeyWords: function(str) {
            if (this.keywords.trim() == "") {
                return true;
            }
            if (this.keywords.trim() == str) {
                return true;
            }
            return false;
        },
        hasArea: function(str) {
            if (this.areas.trim() == "") {
                return true;
            }
            if (this.areas.trim() == str) {
                return true;
            }
            return false;
        },
        hasCategory: function(str) {
            return true;
        },
        search: function() {
            let self = this;
            self.temp = self.venue.map(function(item) {
                if (self.hasKeyWords(item.description)
                    && self.hasArea(item.area)
                    && self.hasCategory(item.categoryIds)) {
                    return item;

                }
            })
        }
    },
        computed: {
        areaOptionList: function() {
            let self = this;
            return Array.from(new Set(self.venue.map(x => x.area)));
        }
    },
    mounted: function() {
        let self = this;
        fetch("/api/Venue")
            .then(function(response) { return response.json() })
            .then(function(result) { self.venue = result; self.temp = result })
    }
})


</script>

